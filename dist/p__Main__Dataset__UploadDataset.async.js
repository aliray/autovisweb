(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{vKWP:function(e,t,a){"use strict";a.r(t);a("T2oS");var s,n,r,i=a("W9HT"),o=(a("DZo9"),a("8z0m")),l=a("jehZ"),c=a.n(l),p=(a("+L6B"),a("2/Rp")),d=(a("/zsF"),a("PArb")),f=(a("Pwec"),a("CtXQ")),u=(a("miYZ"),a("tsqr")),m=a("2Taf"),h=a.n(m),y=a("vZ4D"),v=a.n(y),_=a("l4Ni"),E=a.n(_),w=a("ujKo"),g=a.n(w),L=a("MhPg"),z=a.n(L),C=(a("y8nQ"),a("Vl3Y")),D=a("q1tI"),b=a.n(D),S=a("MuoO"),R=a("3a4m"),k=a.n(R),x=a("4AEC"),A=a.n(x);function N(e){return function(){var t,a=g()(e);if(P()){var s=g()(this).constructor;t=Reflect.construct(a,arguments,s)}else t=a.apply(this,arguments);return E()(this,t)}}function P(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var M=C["a"].Item,T=(s=Object(S["connect"])(function(e){return{success:e.ds.success,error:e.ds.error}}),s((r=function(e){z()(a,e);var t=N(a);function a(){var e;h()(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),e.state={fileList:[],dataset_id:"",dataset_name:"",dataset_type:""},e.beforeUpload=function(t){var a=e.state.fileList,s=0==a.length;if(!s)return u["a"].error("\u53ea\u80fd\u4e0a\u4f201\u4e2a\u6587\u4ef6"),!1;var n="application/x-zip-compressed"===t.type;if(!n)return u["a"].error("\u8bf7\u4e0a\u4f20zip\u683c\u5f0f\u6587\u4ef6"),!1;var r=t.size/1024/1024/1024<2;return r?(console.log(t),e.setState({fileList:[t]}),!1):(u["a"].error("\u4e0a\u4f20\u7684zip\u538b\u7f29\u5305\u4e0d\u80fd\u5927\u4e8e2G!"),!1)},e.saveDataset=function(){var t=e.state,a=t.dataset_id,s=t.dataset_type,n=t.fileList,r=t.dataset_name,i=e.props,o=i.dispatch;i.form;console.log(n),o({type:"ds/uploadDataset",payload:{zipfile:n[0],dataset_id:a,dataset_type:s,fileList:n}}).then(function(){var t=e.props,n=t.success,i=t.error;n?k.a.push("/main/work/opr/"+s+"/lv",{dataset_id:a,dataset_name:r}):console.log(i)})},e}return v()(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.oprKey,a=this.props.location.state,s=a.dataset_id,n=a.dataset_name;this.setState({dataset_id:s,dataset_name:n,dataset_type:t}),setTimeout(function(t){e.setState({spinLoading:!1})},300)}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,s=(a.dataset_id,a.dataset_name),n=a.fileList,r={labelCol:{span:3},wrapperCol:{span:6}},l=function(t){e.setState({fileList:t})},m=function(){e.setState({fileList:[]})},h={name:"zipfile",action:"/ds/upload/zip",headers:{accessControlAllowOrigin:"",accessControlAllowMethods:"*",accessControlAllowHeaders:"x-requested-with,content-type",authorization:"authorization-text"},data:{dataset_id:this.state.dataset_id,dataset_type:this.state.dataset_type},fileList:this.state.fileList,onChange:function(e){if(l(e.fileList),"done"===e.file.status){var t=e.file.response.success;0==t?(u["a"].success("\u4fdd\u5b58\u6570\u636e\u96c6\u6210\u529f"),closeView()):u["a"].error(e.file.response.error)}else"error"===e.file.status&&u["a"].error("".concat(e.fileList[0].name," file upload failed."))},onRemove:function(e){m()}},y=b.a.createElement(f["a"],{type:"loading",style:{fontSize:24},spin:!0});return b.a.createElement("div",null,b.a.createElement(i["a"],{spinning:this.state.spinLoading,indicator:y},b.a.createElement("div",{className:A.a.menuDesc},b.a.createElement("div",{className:A.a.menuDescLeft},"\u6570\u636e\u96c6 ",""!=s&&b.a.createElement("span",null,"> ",this.state.dataset_name)),b.a.createElement("div",{className:A.a.menuDescRight},b.a.createElement("a",null)),b.a.createElement(d["a"],null)),b.a.createElement("div",{className:A.a.detailArea},b.a.createElement(C["a"],r,b.a.createElement(M,{label:"\u6570\u636e\u96c6\u540d\u79f0"},b.a.createElement("div",{style:{fontSize:"12px"}},s)),b.a.createElement(M,{label:"\u4e0a\u4f20\u538b\u7f29\u5305"},t("zipfile")(b.a.createElement(o["a"],c()({},h,{beforeUpload:this.beforeUpload}),b.a.createElement(p["a"],{style:{width:"235px"}},b.a.createElement(f["a"],{type:"upload"}),"Upload")))),b.a.createElement(M,{wrapperCol:{xs:{span:24,offset:0},sm:{span:r.wrapperCol.span,offset:r.labelCol.span}}},0==n.length?b.a.createElement(p["a"],{type:"primary",disabled:!0,onClick:this.saveDataset},"\u786e\u8ba4\u5e76\u8fd4\u56de"):b.a.createElement(p["a"],{type:"primary",onClick:this.saveDataset},"\u786e\u8ba4\u5e76\u8fd4\u56de"))))))}}]),a}(D["Component"]),n=r))||n);t["default"]=C["a"].create()(T)}}]);